<?xml version="1.0" encoding="utf-8"?>
<project>

	<meta title="MidiFeedi" package="com.sample.midifeedi" version="1.0.0" company="Company Name" />
	<app main="Main" path="Export" file="MidiFeedi" />
	
	<!-- Enable console window for debugging -->
	<window width="800" height="600" background="0x000000" fps="60" />
	<unset name="no-console" if="windows" />

	<source path="Source" />
	<source path="MidiSynth/haxe" />
	
	<haxelib name="lime" />
	<haxelib name="haxeui-core" />
	<haxelib name="haxeui-openfl" />
	<haxelib name="openfl" />
	<haxelib name="actuate" />
    <haxelib name="hxcpp" />

	<!-- Assets -->
	<assets path="Assets" />
	
	<!-- MidiSynth C++ Native Extension -->
	<hxcpp include="MidiSynth/cpp/include.xml" />
	
	<!-- Add MidiSynth include paths for C++ target -->
	<section if="cpp">
		<includepath name="MidiSynth/cpp" />
		<includepath name="MidiSynth/cpp/tsf" />
		<!-- Ensure the native bridge is compiled and linked -->
		<file name="MidiSynth/cpp/tsf_bridge.cpp" />
	</section>

	<!-- Ensure native headers are available in the hxcpp include path -->
	<!-- Rely on hxcpp include paths from MidiSynth/cpp/include.xml; avoid copying headers to bin/include -->
	
	<!-- MidiSynth HashLink Native Extension -->
	<section if="hl">
		<!-- HashLink native library (tsf.hdll) is built manually -->
		<!-- After building, copy tsf.hdll into Export/hl/bin before running lime test hl -->
	</section>
	
	<!-- MidiSynth WebAssembly for HTML5 -->
	<section if="html5">
		<!-- Include WASM module and JS glue -->
		<assets path="MidiSynth/wasm/tsf.js" rename="tsf.js" type="text" embed="false" />
		<assets path="MidiSynth/wasm/tsf.wasm" rename="tsf.wasm" type="binary" embed="false" />
		<assets path="MidiSynth/wasm/tsf_glue.js" rename="tsf_glue.js" type="text" embed="false" />
		
		<!-- Include JS files in HTML template -->
		<template path="MidiSynth/wasm/tsf_glue.js" rename="tsf_glue.js" />
	</section>
	
</project>